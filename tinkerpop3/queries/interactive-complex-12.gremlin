g.V().hasLabel('Person').has('id',$personId).out('knows').as('friend').in('hasCreator').hasLabel('Comment').as('comment').filter(out('replyOf').hasLabel('Post').out('hasTag').as('tag').out('hasType').has('name',within($tagClassName))).as('comment').select('friend').groupCount().by(valueMap('id', 'name')).unfold().order().by(select(values), decr).by(select(keys).select('id'), incr).limit(20)