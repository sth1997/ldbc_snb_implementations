g.V().hasLabel('Person').has('id',$personId).out('knows').as('friend').in('hasCreator').hasLabel('Comment').as('comment').filter(out('replyOf').hasLabel('Post').out('hasTag').as('tag').out('hasType').has('name',within($tagClassName))).as('comment').select('friend').groupCount().unfold().order().by(select(values), decr).by('id', incr).limit(20)