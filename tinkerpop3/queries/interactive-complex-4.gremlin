g.V().hasLabel('Person').has('id',$personId).out('knows').store('friends').in('hasCreator').hasLabel('Post').has('creationDate',inside($startDate,$endDate)).out('hasTag').filter(__.in('hasTag').hasLabel('Post').has('creationDate', lt($startDate)).out('hasCreator').where(within('friends')).count().is(0)).groupCount().by(valueMap('id', 'name')).unfold().order().by(select(values),decr).by(select(keys).select('name')).limit(10)