g.V().hasLabel('Person').has('id', $personId).out('knows').union(identity(), out('knows')).dedup().as('p').inE('hasMember').has('joinDate', gt($minDate)).outV().as('f').group().by().by(out('containerOf').hasLabel('Post').out('hasCreator').where(eq('p')).count()).unfold().order().by(select(values), decr).by(select(keys).values('id'), incr).limit(20)