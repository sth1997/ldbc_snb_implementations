g.V().hasLabel('Person').has('id', $personId).out('knows').union(identity(), out('knows')).dedup().store('friend').inE('hasMember').has('joinDate', gt($minDate)).outV().as('forum').dedup().group().by().by(out('containerOf').out('hasCreator').where(within('friend')).count()).unfold().order().by(select(values), decr).by(select(keys).values('id'), incr).limit(20)