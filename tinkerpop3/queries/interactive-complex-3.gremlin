g.V().hasLabel('Person').has('id',$personId).out('knows').union(identity(), out('knows')).dedup().filter(__.out('isLocatedIn').has('name',without('$countryXName','$countryYName'))).as('friend').in('hasCreator').has('creationDate',inside($startDate,$endDate)).filter(__.out('isLocatedIn').has('name',eq('$countryXName'))).groupCount().by(select('friend')).unfold().order().by(select(values), decr).by(select(keys).values('id')).limit(20)
