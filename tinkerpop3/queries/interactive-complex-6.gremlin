g.V().hasLabel('Person').has('id', $personId).out('knows').union(identity(), out('knows')).dedup().by('id').has('id', neq($personId)).in('hasCreator').hasLabel('Post').filter(out('hasTag').values('name').fold().filter({v -> v.get().contains($tagName)})).out('hasTag').has('name', neq($tagName)).groupCount().by('name').unfold().order().by(select(values), decr).by(select(keys), incr).limit(10)