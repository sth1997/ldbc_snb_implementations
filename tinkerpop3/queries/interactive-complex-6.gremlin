g.V().hasLabel('Person').has('id', $personId).out('knows').union(identity(), out('knows')).dedup().has('id', neq($personId)).in('hasCreator').hasLabel('Post').filter(out('hasTag').values('name').fold().filter(Lists.containsAll(Lists.of('$tagName')))).out('hasTag').has('name', neq('$tagName')).groupCount().unfold().order().by(select(values), decr).by(select(keys).values('name'), incr).limit(10)